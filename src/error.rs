use std::error::Error;
use std::fmt::{Display, Formatter};
use serde::{Deserialize, Serialize};
use crate::error::CloudreveError::Unknown;

#[derive(Debug, Deserialize, Serialize, Clone)]
#[repr(u32)]
pub enum CloudreveError{
    Ok = 0,
    Unknown = 1,
    NotFullySuccessful = 203,
    NotLoggedIn = 401,
    NoPermissionToAccess = 403,
    ResourceNotFound = 404,
    ResourceConflict = 409,
    ParameterError = 40001,
    UploadFailed = 40002,
    FolderCreationFailed = 40003,
    ObjectAlreadyExists = 40004,
    SignatureExpired = 40005,
    CurrentStoragePolicyNotAllowed = 40006,
    UserGroupNotAllowedForThisOperation = 40007,
    AdminPrivilegesRequired = 40008,
    MasterNodeNotRegistered = 40009,
    PhoneBindingRequired = 40010,
    UploadSessionExpired = 40011,
    InvalidChunkIndex = 40012,
    InvalidContentLength = 40013,
    BatchSourceSizeLimitExceeded = 40014,
    MaximumAria2TaskLimitExceeded = 40015,
    ParentDirectoryDoesNotExist = 40016,
    UserBanned = 40017,
    UserNotActivated = 40018,
    FeatureNotEnabled = 40019,
    InvalidCredentials = 40020,
    UserNotFound = 40021,
    MFACodeError = 40022,
    LoginSessionDoesNotExist = 40023,
    CannotInitializeWebAuthn = 40024,
    InvalidWebAuthnCredential = 40025,
    CaptchaError = 40026,
    CaptchaRefreshNeeded = 40027,
    FailedToSendEmail = 40028,
    InvalidTemporaryLink = 40029,
    TemporaryLinkExpired = 40030,
    EmailProviderBanned = 40031,
    EmailAlreadyExists = 40032,
    EmailHasBeenResent = 40033,
    UserCannotBeActivated = 40034,
    StoragePolicyDoesNotExist = 40035,
    CannotDeleteDefaultStoragePolicy = 40036,
    StoragePolicyStillHasFiles = 40037,
    StoragePolicyBoundToUserGroups = 40038,
    UserGroupNotFound = 40039,
    InvalidActionOnSystemGroup = 40040,
    UserGroupInUse = 40041,
    CannotChangeGroupForDefaultUser = 40042,
    InvalidActionOnDefaultUser = 40043,
    FileNotFound = 40044,
    FailedToListFiles = 40045,
    InvalidActionOnSystemNode = 40046,
    FailedToCreateFileSystem = 40047,
    FailedToCreateTask = 40048,
    FileTooLarge = 40049,
    FileTypeNotAllowed = 40050,
    InsufficientUserCapacity = 40051,
    IllegalObjectName = 40052,
    RootDirectoryProtected = 40053,
    FileWithSameNameBeingUploaded = 40054,
    MetadataMismatch = 40055,
    UnsupportedArchiveType = 40056,
    AvailableStoragePolicyChanged = 40057,
    ShareLinkNotFound = 40058,
    CannotSaveOwnShare = 40059,
    SlaveCannotSendCallbackToMaster = 40060,
    CloudreveVersionMismatch = 40061,
    InsufficientCredit = 40062,
    GroupConflict = 40063,
    AlreadyInCurrentUserGroup = 40064,
    InvalidGiftCode = 40065,
    AccountAlreadyBound = 40066,
    AccountBoundToAnotherUser = 40067,
    AccountNotLinked = 40068,
    IncorrectPassword = 40069,
    SharePreviewDisabled = 40070,
    InvalidSignature = 40071,
    AdminCannotPurchaseUserGroup = 40072,
    LockConflict = 40073,
    TooManyURIs = 40074,
    LockTokenExpired = 40075,
    CurrentVersionIsStale = 40076,
    EntityDoesNotExist = 40077,
    FileIsInRecycleBin = 40078,
    FileCountLimitReached = 40079,
    InvalidPassword = 40080,
    BatchOperationNotFullyCompleted = 40081,
    OwnerOperationOnly = 40082,
    PurchaseRequired = 40083,
    ManagedAccountMinimumOpenID = 40084,
    AmountTooSmall = 40085,
    NodeUsedByStoragePolicy = 40086,
    DomainNotLicensed = 40087,
    AnonymousUserNotAllowed = 40088,
    DatabaseOperationFailed = 50001,
    EncryptionFailed = 50002,
    IOOperationFailed = 50004,
    InternalSettingParameterError = 50005,
    CacheOperationFailed = 50006,
    CallbackFailed = 50007,
    FailedToUpdateBackendSettings = 50008,
    FailedToAddCORSPolicy = 50009,
    NodeOffline = 50010,
    FailedToQueryFileMetadata = 50011,
}

impl Display for CloudreveError{
    fn fmt(&self, f: &mut Formatter<'_>) -> std::fmt::Result{
        write!(f, "{}: {}", self.clone() as u32, self)
    }
}
impl Error for CloudreveError{}
impl CloudreveError {
    /// 将 u32 转换为 CloudreveError 枚举
    pub fn from_u32(value: u32) -> CloudreveError {
        match value {
            0 => CloudreveError::Ok,
            1 => CloudreveError::Unknown,
            203 => CloudreveError::NotFullySuccessful,
            401 => CloudreveError::NotLoggedIn,
            403 => CloudreveError::NoPermissionToAccess,
            404 => CloudreveError::ResourceNotFound,
            409 => CloudreveError::ResourceConflict,
            40001 => CloudreveError::ParameterError,
            40002 => CloudreveError::UploadFailed,
            40003 => CloudreveError::FolderCreationFailed,
            40004 => CloudreveError::ObjectAlreadyExists,
            40005 => CloudreveError::SignatureExpired,
            40006 => CloudreveError::CurrentStoragePolicyNotAllowed,
            40007 => CloudreveError::UserGroupNotAllowedForThisOperation,
            40008 => CloudreveError::AdminPrivilegesRequired,
            40009 => CloudreveError::MasterNodeNotRegistered,
            40010 => CloudreveError::PhoneBindingRequired,
            40011 => CloudreveError::UploadSessionExpired,
            40012 => CloudreveError::InvalidChunkIndex,
            40013 => CloudreveError::InvalidContentLength,
            40014 => CloudreveError::BatchSourceSizeLimitExceeded,
            40015 => CloudreveError::MaximumAria2TaskLimitExceeded,
            40016 => CloudreveError::ParentDirectoryDoesNotExist,
            40017 => CloudreveError::UserBanned,
            40018 => CloudreveError::UserNotActivated,
            40019 => CloudreveError::FeatureNotEnabled,
            40020 => CloudreveError::InvalidCredentials,
            40021 => CloudreveError::UserNotFound,
            40022 => CloudreveError::MFACodeError,
            40023 => CloudreveError::LoginSessionDoesNotExist,
            40024 => CloudreveError::CannotInitializeWebAuthn,
            40025 => CloudreveError::InvalidWebAuthnCredential,
            40026 => CloudreveError::CaptchaError,
            40027 => CloudreveError::CaptchaRefreshNeeded,
            40028 => CloudreveError::FailedToSendEmail,
            40029 => CloudreveError::InvalidTemporaryLink,
            40030 => CloudreveError::TemporaryLinkExpired,
            40031 => CloudreveError::EmailProviderBanned,
            40032 => CloudreveError::EmailAlreadyExists,
            40033 => CloudreveError::EmailHasBeenResent,
            40034 => CloudreveError::UserCannotBeActivated,
            40035 => CloudreveError::StoragePolicyDoesNotExist,
            40036 => CloudreveError::CannotDeleteDefaultStoragePolicy,
            40037 => CloudreveError::StoragePolicyStillHasFiles,
            40038 => CloudreveError::StoragePolicyBoundToUserGroups,
            40039 => CloudreveError::UserGroupNotFound,
            40040 => CloudreveError::InvalidActionOnSystemGroup,
            40041 => CloudreveError::UserGroupInUse,
            40042 => CloudreveError::CannotChangeGroupForDefaultUser,
            40043 => CloudreveError::InvalidActionOnDefaultUser,
            40044 => CloudreveError::FileNotFound,
            40045 => CloudreveError::FailedToListFiles,
            40046 => CloudreveError::InvalidActionOnSystemNode,
            40047 => CloudreveError::FailedToCreateFileSystem,
            40048 => CloudreveError::FailedToCreateTask,
            40049 => CloudreveError::FileTooLarge,
            40050 => CloudreveError::FileTypeNotAllowed,
            40051 => CloudreveError::InsufficientUserCapacity,
            40052 => CloudreveError::IllegalObjectName,
            40053 => CloudreveError::RootDirectoryProtected,
            40054 => CloudreveError::FileWithSameNameBeingUploaded,
            40055 => CloudreveError::MetadataMismatch,
            40056 => CloudreveError::UnsupportedArchiveType,
            40057 => CloudreveError::AvailableStoragePolicyChanged,
            40058 => CloudreveError::ShareLinkNotFound,
            40059 => CloudreveError::CannotSaveOwnShare,
            40060 => CloudreveError::SlaveCannotSendCallbackToMaster,
            40061 => CloudreveError::CloudreveVersionMismatch,
            40062 => CloudreveError::InsufficientCredit,
            40063 => CloudreveError::GroupConflict,
            40064 => CloudreveError::AlreadyInCurrentUserGroup,
            40065 => CloudreveError::InvalidGiftCode,
            40066 => CloudreveError::AccountAlreadyBound,
            40067 => CloudreveError::AccountBoundToAnotherUser,
            40068 => CloudreveError::AccountNotLinked,
            40069 => CloudreveError::IncorrectPassword,
            40070 => CloudreveError::SharePreviewDisabled,
            40071 => CloudreveError::InvalidSignature,
            40072 => CloudreveError::AdminCannotPurchaseUserGroup,
            40073 => CloudreveError::LockConflict,
            40074 => CloudreveError::TooManyURIs,
            40075 => CloudreveError::LockTokenExpired,
            40076 => CloudreveError::CurrentVersionIsStale,
            40077 => CloudreveError::EntityDoesNotExist,
            40078 => CloudreveError::FileIsInRecycleBin,
            40079 => CloudreveError::FileCountLimitReached,
            40080 => CloudreveError::InvalidPassword,
            40081 => CloudreveError::BatchOperationNotFullyCompleted,
            40082 => CloudreveError::OwnerOperationOnly,
            40083 => CloudreveError::PurchaseRequired,
            40084 => CloudreveError::ManagedAccountMinimumOpenID,
            40085 => CloudreveError::AmountTooSmall,
            40086 => CloudreveError::NodeUsedByStoragePolicy,
            40087 => CloudreveError::DomainNotLicensed,
            40088 => CloudreveError::AnonymousUserNotAllowed,
            50001 => CloudreveError::DatabaseOperationFailed,
            50002 => CloudreveError::EncryptionFailed,
            50004 => CloudreveError::IOOperationFailed,
            50005 => CloudreveError::InternalSettingParameterError,
            50006 => CloudreveError::CacheOperationFailed,
            50007 => CloudreveError::CallbackFailed,
            50008 => CloudreveError::FailedToUpdateBackendSettings,
            50009 => CloudreveError::FailedToAddCORSPolicy,
            50010 => CloudreveError::NodeOffline,
            50011 => CloudreveError::FailedToQueryFileMetadata,
            _ => CloudreveError::Unknown, // 如果没有匹配到任何值，则返回 Unknown
        }
    }
}