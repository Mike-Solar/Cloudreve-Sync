# Cloudreve 同步客户端 UI 设计稿  
**后端：Cloudreve 官方 API（非 WebDAV）**  
**同步策略：双向同步 · 冲突双保留（云端保留原名） · 全量 SHA256 · 软删除**

---

## 1. 信息架构（Information Architecture）

### 1.1 全局布局
- **左侧导航栏（Primary Navigation）**
  - 概览
  - 同步任务
  - 冲突中心
  - 活动日志
  - 设置
  - 关于 / 诊断（可选）

- **顶部栏（Global Header）**
  - 当前账号 / 站点切换
  - 搜索（任务 / 文件 / 日志）
  - 网络状态 / API 状态指示
  - 帮助 / 文档入口

---

## 2. 页面设计

## 2.1 概览（Dashboard）

### 目标
快速了解：
- 同步是否正常
- 是否存在冲突
- 当前是否有错误或阻塞

### 页面结构
- **状态卡片区（Top Cards）**
  - 同步状态：运行中 / 已暂停 / 错误
  - 今日上传量
  - 今日下载量
  - 未处理冲突数（红色高亮）

- **当前任务区**
  - 最近活动的 3 个同步任务
  - 显示：
    - 任务名
    - 同步模式（双向 / 单向）
    - 本地路径 ↔ 云端路径
    - 当前进度条
    - 实时速率（↑ / ↓）
    - ETA
  - 快捷操作：
    - 暂停 / 继续
    - 打开本地目录
    - 打开云端目录
    - 查看任务详情

- **最近活动**
  - 时间线展示最近 20 条事件：
    - 上传 / 下载
    - 冲突产生
    - 软删除标记
    - 错误 / 重试

---

## 2.2 同步任务（Tasks）

### 目标
集中管理所有同步任务，控制与观察同步过程。

### 列表视图
表格字段：
- 启用状态（开关）
- 任务名
- 同步模式（单向 / 双向）
- 本地目录
- 云端目录
- 状态（Idle / Syncing / Paused / Error）
- 当前速率（↑ / ↓）
- 队列文件数
- 上次成功同步时间
- 操作菜单（⋯）

### 顶部工具栏
- `+ 新建任务`
- 批量操作：
  - 暂停
  - 继续
  - 删除
- 筛选：
  - 仅显示错误
  - 仅显示存在冲突
  - 最近 24 小时活跃

---

### 任务详情抽屉（Drawer）

#### 概览
- 当前状态
- 正在处理的文件
- 实时进度条
- 实时速率
- 剩余时间估算

#### 统计
- 今日 / 本周上传下载量
- 失败次数
- 重试次数

#### 控制
- 暂停 / 继续
- 立即同步
- 重新扫描（Re-scan）

#### 配置（允许修改项）
- 上传并发数
- 下载并发数
- 上传 / 下载限速
- 过滤规则（include / exclude）
- 冲突副本位置：
  - 同目录
  - `.conflicts` 子目录
- 本地软删除方式：
  - 系统回收站
  - `.trash` 目录

---

## 2.3 新建同步任务向导（Wizard）

### Step 1：账号与站点
- Cloudreve Base URL
- 登录方式：
  - 用户名 + 密码
  - Token
- 测试连接按钮
- 成功提示后进入下一步

---

### Step 2：选择同步目录
- 本地目录选择器
- 云端目录树选择器
- 路径映射预览：
  - 本地：`/Users/me/Work`
  - 云端：`/Work`

---

### Step 3：同步策略确认
- 同步模式：**双向同步（默认）**
- 冲突策略：  
  - 冲突双保留（云端保留原名）【只读说明】
- 删除策略：  
  - 软删除（打删除标记）【只读说明】
- 高级选项（可展开）：
  - 过滤规则
  - 并发 / 限速

---

### Step 4：首次同步行为
- 立即同步
- 仅建立索引（不传输）
- 提示信息：
  - 将计算全量 SHA256
  - 不会覆盖文件
  - 冲突将自动生成副本

---

## 2.4 冲突中心（Conflict Center）

### 目标
让冲突 **可理解、可追溯、不可破坏**

### 左侧：冲突列表
- 每条冲突显示：
  - 文件名
  - 所属任务
  - 目录路径
  - 冲突时间
  - 来源设备
- 筛选条件：
  - 未处理 / 已处理
  - 按任务
  - 按目录
  - 按时间范围
- 批量操作：
  - 标记为“已知晓”
  - 导出冲突清单（CSV / JSON）

---

### 右侧：冲突详情
- 冲突摘要
  - 原文件名（云端保留）
  - 冲突副本名（conflict-*）

- 双栏对比卡片：
  - 左：云端版本
  - 右：冲突副本
  - 展示字段：
    - sync:mtime_ms
    - sha256
    - size
    - device_id
    - 上次同步时间

- 操作按钮：
  - 下载云端版本（另存为）
  - 打开文件所在目录
  - 复制 sha256
  - 标记冲突为已处理

> 注意：  
> UI 不提供“覆盖 / 合并”按钮，符合双保留策略。

---

## 2.5 活动日志（Activity Log）

### 目标
问题可定位、行为可审计。

### 功能
- 筛选：
  - 任务
  - 日志级别（info / warn / error）
  - 操作类型（upload / download / conflict / delete / retry）
  - 时间范围
- 搜索：
  - 文件名
  - 路径
  - 错误码
- 日志详情展开：
  - API 接口名
  - 请求耗时
  - 重试次数
  - HTTP 状态码
  - Cloudreve 错误信息

### 导出
- 一键导出诊断包（脱敏）：
  - 日志
  - 配置（去 token）
  - 系统环境信息

---

## 2.6 设置（Settings）

### 通用
- 开机自启动
- 托盘图标
- 语言 / 主题

### 网络
- 代理设置
- 最大重试次数
- 退避策略

### 性能
- 默认上传 / 下载并发
- 默认限速
- SHA256 计算线程数

### 安全
- 清除登录凭据
- 锁屏后暂停同步（可选）

### 高级
- 调试模式
- API Trace（仅开发者）

---

## 3. 关键交互设计要点

1. **三态任务状态**
   - 运行中（绿）
   - 已暂停（黄）
   - 错误（红，可点击查看原因）

2. **软删除可视化**
   - 日志中显示“标记删除”
   - 可查看已软删除文件（只读）

3. **首次同步安全提示**
   - 明确说明不会覆盖文件
   - 冲突自动生成副本

4. **权限与路径校验**
   - 本地目录读写权限
   - 云端目录上传权限

---

## 4. 简易线框示意（ASCII）

```
┌──────────────────────────────────────────────────────────────┐
│ Cloudreve Sync [账号▼] [搜索🔎] │
├───────┬──────────────────────────────────────────────────────┤
│ 概览 │ 同步任务 +新建任务 [仅错误] [仅冲突] [最近活跃] │
│ 任务 ├──────────────────────────────────────────────────────┤
│ 冲突 │ ☐ 启用 任务名 模式 状态 ↑↓速率 队列 上次同步 │
│ 日志 │ ☑ Work 双向 Sync 3.2/1.1 12 10:22 │
│ 设置 │ ☑ Photos 单向→ Idle -- 0 昨天 │
│ │ ☐ Docs 双向 Error -- 5 -- │
├───────┴──────────────────────────────────────────────────────┤
│ 任务详情抽屉：进度、当前文件、暂停/继续、配置等 │
└──────────────────────────────────────────────────────────────┘
```

---

## 5. UI 设计结论

- UI 重点在 **可解释性与安全感**
- 冲突中心是核心差异化功能
- 所有不可逆操作必须弱化或移除
- 与同步策略严格一致：  
  **不覆盖、不合并、只双保留**

---

**状态：UI 设计冻结，可进入视觉设计 / 前端实现阶段**
